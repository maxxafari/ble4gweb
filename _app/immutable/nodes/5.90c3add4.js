import{s as ie,n as z,c as se,r as oe,b as ae}from"../chunks/scheduler.aa60952c.js";import{S as ce,i as fe,s as C,g as p,B as re,f as c,c as x,h as v,j as w,a as u,A as T,y as g,m as te,n as le,k as A,D as J,C as B,F as de}from"../chunks/index.a7391ef6.js";import{e as ue,c as _e,p as me}from"../chunks/peers.c88dee28.js";import{w as pe}from"../chunks/index.9adb9ad6.js";function K(s){return(s==null?void 0:s.length)!==void 0?s:Array.from(s)}const ve=!1,he=!0,we=Object.freeze(Object.defineProperty({__proto__:null,prerender:he,ssr:ve},Symbol.toStringTag,{value:"Module"})),be=async s=>{console.info("Creating new peer2"),await _e(me,s)},ne=pe(ue,()=>(console.info("new subscription for perStore2"),be(ne),()=>{console.info("No subscription  peer2")}));function Q(s,l,a){const n=s.slice();return n[10]=l[a],n}function Y(s){let l,a="Waiting for call (NOT initiator)",n,e,i="<h4>Waiting for call from peer1</h4>";return{c(){l=p("p"),l.textContent=a,n=C(),e=p("div"),e.innerHTML=i},l(o){l=v(o,"P",{"data-svelte-h":!0}),g(l)!=="svelte-y1cfax"&&(l.textContent=a),n=x(o),e=v(o,"DIV",{"data-svelte-h":!0}),g(e)!=="svelte-pb42gt"&&(e.innerHTML=i)},m(o,f){u(o,l,f),u(o,n,f),u(o,e,f)},d(o){o&&(c(l),c(n),c(e))}}}function Z(s){let l,a="<h4>Connected to peer1</h4>",n,e,i,o,f,S="Send",I,b,V="0",D,_,F="1",H,k,L,R="data",U,O,M,P,y,E,W,X,j=K(s[4]),m=[];for(let t=0;t<j.length;t+=1)m[t]=$(Q(s,j,t));let h=!s[1].mediaStream&&ee();return{c(){l=p("div"),l.innerHTML=a,n=C(),e=p("div"),i=p("textarea"),o=C(),f=p("button"),f.textContent=S,I=C(),b=p("button"),b.textContent=V,D=C(),_=p("button"),_.textContent=F,H=C(),k=p("div"),L=p("h3"),L.textContent=R,U=C(),O=p("ul");for(let t=0;t<m.length;t+=1)m[t].c();M=te(`
		w `),h&&h.c(),P=C(),y=p("div"),E=p("video"),this.h()},l(t){l=v(t,"DIV",{"data-svelte-h":!0}),g(l)!=="svelte-195tsj"&&(l.innerHTML=a),n=x(t),e=v(t,"DIV",{});var r=w(e);i=v(r,"TEXTAREA",{id:!0,class:!0}),w(i).forEach(c),o=x(r),f=v(r,"BUTTON",{"data-svelte-h":!0}),g(f)!=="svelte-16kuoif"&&(f.textContent=S),r.forEach(c),I=x(t),b=v(t,"BUTTON",{"data-svelte-h":!0}),g(b)!=="svelte-tsty6j"&&(b.textContent=V),D=x(t),_=v(t,"BUTTON",{"data-svelte-h":!0}),g(_)!=="svelte-ycwsfx"&&(_.textContent=F),H=x(t),k=v(t,"DIV",{});var d=w(k);L=v(d,"H3",{"data-svelte-h":!0}),g(L)!=="svelte-1fkupqc"&&(L.textContent=R),U=x(d),O=v(d,"UL",{});var N=w(O);for(let q=0;q<m.length;q+=1)m[q].l(N);N.forEach(c),d.forEach(c),M=le(t,`
		w `),h&&h.l(t),P=x(t),y=v(t,"DIV",{class:!0});var G=w(y);E=v(G,"VIDEO",{class:!0}),w(E).forEach(c),G.forEach(c),this.h()},h(){A(i,"id","send"),A(i,"class","svelte-12v1rwn"),E.autoplay=!0,E.muted=!0,A(E,"class","svelte-12v1rwn"),A(y,"class","video-container")},m(t,r){u(t,l,r),u(t,n,r),u(t,e,r),T(e,i),J(i,s[2]),T(e,o),T(e,f),u(t,I,r),u(t,b,r),u(t,D,r),u(t,_,r),u(t,H,r),u(t,k,r),T(k,L),T(k,U),T(k,O);for(let d=0;d<m.length;d+=1)m[d]&&m[d].m(O,null);u(t,M,r),h&&h.m(t,r),u(t,P,r),u(t,y,r),T(y,E),s[9](E),W||(X=[B(i,"input",s[5]),B(f,"click",s[6]),B(b,"click",s[7]),B(_,"click",s[8])],W=!0)},p(t,r){if(r&4&&J(i,t[2]),r&16){j=K(t[4]);let d;for(d=0;d<j.length;d+=1){const N=Q(t,j,d);m[d]?m[d].p(N,r):(m[d]=$(N),m[d].c(),m[d].m(O,null))}for(;d<m.length;d+=1)m[d].d(1);m.length=j.length}t[1].mediaStream?h&&(h.d(1),h=null):h||(h=ee(),h.c(),h.m(P.parentNode,P))},d(t){t&&(c(l),c(n),c(e),c(I),c(b),c(D),c(_),c(H),c(k),c(M),c(P),c(y)),de(m,t),h&&h.d(t),s[9](null),W=!1,oe(X)}}}function $(s){let l,a=s[10]+"",n;return{c(){l=p("li"),n=te(a)},l(e){l=v(e,"LI",{});var i=w(l);n=le(i,a),i.forEach(c)},m(e,i){u(e,l,i),T(l,n)},p:z,d(e){e&&c(l)}}}function ee(s){let l,a="No video streamed";return{c(){l=p("p"),l.textContent=a},l(n){l=v(n,"P",{"data-svelte-h":!0}),g(l)!=="svelte-1p0v38x"&&(l.textContent=a)},m(n,e){u(n,l,e)},d(n){n&&c(l)}}}function Ce(s){let l,a,n,e=!s[1].connected&&Y(),i=s[1].connected&&Z(s);return{c(){l=C(),a=p("div"),e&&e.c(),n=C(),i&&i.c(),this.h()},l(o){re("svelte-1y0w2j6",document.head).forEach(c),l=x(o),a=v(o,"DIV",{});var S=w(a);e&&e.l(S),n=x(S),i&&i.l(S),S.forEach(c),this.h()},h(){document.title="Peer2"},m(o,f){u(o,l,f),u(o,a,f),e&&e.m(a,null),T(a,n),i&&i.m(a,null)},p(o,[f]){o[1].connected?e&&(e.d(1),e=null):e||(e=Y(),e.c(),e.m(a,n)),o[1].connected?i?i.p(o,f):(i=Z(o),i.c(),i.m(a,null)):i&&(i.d(1),i=null)},i:z,o:z,d(o){o&&(c(l),c(a)),e&&e.d(),i&&i.d()}}}function xe(s,l,a){let n;se(s,ne,_=>a(1,n=_));let e="",i=[],o,f=n.command;function S(){e=this.value,a(2,e)}const I=()=>{var _;(_=n.dataConn)==null||_.send(e),a(2,e="")},b=()=>f.setLed(1,!1),V=()=>f.setLed(1,!0);function D(_){ae[_?"unshift":"push"](()=>{o=_,a(0,o),a(1,n)})}return s.$$.update=()=>{s.$$.dirty&3&&(n.mediaStream&&o&&a(0,o.srcObject=n.mediaStream,o),n.dataConn&&(n.dataConn.on("data",_=>{console.log("got data: ",_)}),a(3,f=n.command)))},[o,n,e,f,i,S,I,b,V,D]}class ge extends ce{constructor(l){super(),fe(this,l,xe,Ce,ie,{})}}export{ge as component,we as universal};
