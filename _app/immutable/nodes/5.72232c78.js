import{s as oe,n as G,c as ae,r as ce,b as fe}from"../chunks/scheduler.aa60952c.js";import{S as ue,i as re,s as x,g as m,B as de,f as c,c as S,h as _,j as w,a as d,A as E,y as I,m as le,n as ie,k as D,D as z,C as M,F as pe,E as me}from"../chunks/index.a7391ef6.js";import{e as _e,c as ve,p as he}from"../chunks/peers.c88dee28.js";import{w as be}from"../chunks/index.9adb9ad6.js";function Y(i){return(i==null?void 0:i.length)!==void 0?i:Array.from(i)}const Ce=!1,xe=!0,Ie=Object.freeze(Object.defineProperty({__proto__:null,prerender:xe,ssr:Ce},Symbol.toStringTag,{value:"Module"})),Se=async i=>{console.info("Creating new peer2"),await ve(he,i)},se=be(_e,()=>(console.info("new subscription for perStore2"),Se(se),()=>{console.info("No subscription  peer2")}));function Z(i,n,o){const l=i.slice();return l[12]=n[o],l}function $(i){let n,o="Waiting for call (NOT initiator)",l,t,s="<h4>Waiting for call from peer1</h4>";return{c(){n=m("p"),n.textContent=o,l=x(),t=m("div"),t.innerHTML=s},l(a){n=_(a,"P",{"data-svelte-h":!0}),I(n)!=="svelte-y1cfax"&&(n.textContent=o),l=S(a),t=_(a,"DIV",{"data-svelte-h":!0}),I(t)!=="svelte-pb42gt"&&(t.innerHTML=s)},m(a,u){d(a,n,u),d(a,l,u),d(a,t,u)},d(a){a&&(c(n),c(l),c(t))}}}function ee(i){let n,o="<h4>Connected to peer1</h4>",l,t,s,a,u,b="Send",L,T,A="0",N,k,B="1",h,C,W,g,O,J="data",F,j,q,V,P,y,R,K,H=Y(i[5]),p=[];for(let e=0;e<H.length;e+=1)p[e]=te(Z(i,H,e));let v=!i[3].mediaStream&&ne();return{c(){n=m("div"),n.innerHTML=o,l=x(),t=m("div"),s=m("textarea"),a=x(),u=m("button"),u.textContent=b,L=x(),T=m("button"),T.textContent=A,N=x(),k=m("button"),k.textContent=B,h=x(),C=m("input"),W=x(),g=m("div"),O=m("h3"),O.textContent=J,F=x(),j=m("ul");for(let e=0;e<p.length;e+=1)p[e].c();q=le(`
		w `),v&&v.c(),V=x(),P=m("div"),y=m("video"),this.h()},l(e){n=_(e,"DIV",{"data-svelte-h":!0}),I(n)!=="svelte-195tsj"&&(n.innerHTML=o),l=S(e),t=_(e,"DIV",{});var f=w(t);s=_(f,"TEXTAREA",{id:!0,class:!0}),w(s).forEach(c),a=S(f),u=_(f,"BUTTON",{"data-svelte-h":!0}),I(u)!=="svelte-16kuoif"&&(u.textContent=b),f.forEach(c),L=S(e),T=_(e,"BUTTON",{"data-svelte-h":!0}),I(T)!=="svelte-tsty6j"&&(T.textContent=A),N=S(e),k=_(e,"BUTTON",{"data-svelte-h":!0}),I(k)!=="svelte-ycwsfx"&&(k.textContent=B),h=S(e),C=_(e,"INPUT",{type:!0,min:!0,max:!0}),W=S(e),g=_(e,"DIV",{});var r=w(g);O=_(r,"H3",{"data-svelte-h":!0}),I(O)!=="svelte-1fkupqc"&&(O.textContent=J),F=S(r),j=_(r,"UL",{});var U=w(j);for(let X=0;X<p.length;X+=1)p[X].l(U);U.forEach(c),r.forEach(c),q=ie(e,`
		w `),v&&v.l(e),V=S(e),P=_(e,"DIV",{class:!0});var Q=w(P);y=_(Q,"VIDEO",{class:!0}),w(y).forEach(c),Q.forEach(c),this.h()},h(){D(s,"id","send"),D(s,"class","svelte-12v1rwn"),D(C,"type","range"),D(C,"min","0"),D(C,"max","180"),y.autoplay=!0,y.muted=!0,D(y,"class","svelte-12v1rwn"),D(P,"class","video-container")},m(e,f){d(e,n,f),d(e,l,f),d(e,t,f),E(t,s),z(s,i[4]),E(t,a),E(t,u),d(e,L,f),d(e,T,f),d(e,N,f),d(e,k,f),d(e,h,f),d(e,C,f),z(C,i[2]),d(e,W,f),d(e,g,f),E(g,O),E(g,F),E(g,j);for(let r=0;r<p.length;r+=1)p[r]&&p[r].m(j,null);d(e,q,f),v&&v.m(e,f),d(e,V,f),d(e,P,f),E(P,y),i[11](y),R||(K=[M(s,"input",i[6]),M(u,"click",i[7]),M(T,"click",i[8]),M(k,"click",i[9]),M(C,"change",i[10]),M(C,"input",i[10])],R=!0)},p(e,f){if(f&16&&z(s,e[4]),f&4&&z(C,e[2]),f&32){H=Y(e[5]);let r;for(r=0;r<H.length;r+=1){const U=Z(e,H,r);p[r]?p[r].p(U,f):(p[r]=te(U),p[r].c(),p[r].m(j,null))}for(;r<p.length;r+=1)p[r].d(1);p.length=H.length}e[3].mediaStream?v&&(v.d(1),v=null):v||(v=ne(),v.c(),v.m(V.parentNode,V))},d(e){e&&(c(n),c(l),c(t),c(L),c(T),c(N),c(k),c(h),c(C),c(W),c(g),c(q),c(V),c(P)),pe(p,e),v&&v.d(e),i[11](null),R=!1,ce(K)}}}function te(i){let n,o=i[12]+"",l;return{c(){n=m("li"),l=le(o)},l(t){n=_(t,"LI",{});var s=w(n);l=ie(s,o),s.forEach(c)},m(t,s){d(t,n,s),E(n,l)},p:G,d(t){t&&c(n)}}}function ne(i){let n,o="No video streamed";return{c(){n=m("p"),n.textContent=o},l(l){n=_(l,"P",{"data-svelte-h":!0}),I(n)!=="svelte-1p0v38x"&&(n.textContent=o)},m(l,t){d(l,n,t)},d(l){l&&c(n)}}}function Te(i){let n,o,l,t=!i[3].connected&&$(),s=i[3].connected&&ee(i);return{c(){n=x(),o=m("div"),t&&t.c(),l=x(),s&&s.c(),this.h()},l(a){de("svelte-1y0w2j6",document.head).forEach(c),n=S(a),o=_(a,"DIV",{});var b=w(o);t&&t.l(b),l=S(b),s&&s.l(b),b.forEach(c),this.h()},h(){document.title="Peer2"},m(a,u){d(a,n,u),d(a,o,u),t&&t.m(o,null),E(o,l),s&&s.m(o,null)},p(a,[u]){a[3].connected?t&&(t.d(1),t=null):t||(t=$(),t.c(),t.m(o,l)),a[3].connected?s?s.p(a,u):(s=ee(a),s.c(),s.m(o,null)):s&&(s.d(1),s=null)},i:G,o:G,d(a){a&&(c(n),c(o)),t&&t.d(),s&&s.d()}}}function ke(i,n,o){let l;ae(i,se,h=>o(3,l=h));let t="",s=[],a,u=l.command,b=0;function L(){t=this.value,o(4,t)}const T=()=>{var h;(h=l.dataConn)==null||h.send(t),o(4,t="")},A=()=>u.setLed(1,!1),N=()=>u.setLed(1,!0);function k(){b=me(this.value),o(2,b)}function B(h){fe[h?"unshift":"push"](()=>{a=h,o(0,a),o(3,l)})}return i.$$.update=()=>{i.$$.dirty&9&&(l.mediaStream&&a&&o(0,a.srcObject=l.mediaStream,a),l.dataConn&&(l.dataConn.on("data",h=>{console.log("got data: ",h)}),o(1,u=l.command))),i.$$.dirty&6&&b&&u.setServo(1,b)},[a,u,b,l,t,s,L,T,A,N,k,B]}class Pe extends ue{constructor(n){super(),re(this,n,ke,Te,oe,{})}}export{Pe as component,Ie as universal};
