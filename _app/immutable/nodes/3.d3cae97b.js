import{s as $,n as G,r as ee}from"../chunks/scheduler.b0c1c2c3.js";import{S as te,i as le,g as m,s as y,h as g,j as x,y as w,c as T,f as h,a as E,A as p,m as A,n as M,k as R,D as X,C as F,o as Z,E as ne}from"../chunks/index.00179a67.js";import{e as J,P as oe}from"../chunks/simplepeer.min.88c063de.js";import{g as se,C as ae}from"../chunks/signalServer.39f3696e.js";const re=!1,ie=!0,pe=Object.freeze(Object.defineProperty({__proto__:null,prerender:ie,ssr:re},Symbol.toStringTag,{value:"Module"}));function K(f,e,l){const t=f.slice();return t[7]=e[l],t}function Q(f){let e,l="<h4>Calling peer2</h4>";return{c(){e=m("div"),e.innerHTML=l},l(t){e=g(t,"DIV",{"data-svelte-h":!0}),w(e)!=="svelte-yfs20s"&&(e.innerHTML=l)},m(t,r){E(t,e,r)},d(t){t&&h(e)}}}function W(f){let e,l,t="Connected",r,o,s,a=f[1]?"true":"false",u,_,C,c,I,b,N="Send",L,k,D,q="data",j,O,H,U,P=J(f[3]),d=[];for(let n=0;n<P.length;n+=1)d[n]=Y(K(f,P,n));return{c(){e=m("div"),l=m("h4"),l.textContent=t,r=y(),o=m("p"),s=A("connected: "),u=A(a),_=y(),C=m("div"),c=m("textarea"),I=y(),b=m("button"),b.textContent=N,L=y(),k=m("div"),D=m("h3"),D.textContent=q,j=y(),O=m("ul");for(let n=0;n<d.length;n+=1)d[n].c();this.h()},l(n){e=g(n,"DIV",{});var v=x(e);l=g(v,"H4",{"data-svelte-h":!0}),w(l)!=="svelte-znzixf"&&(l.textContent=t),r=T(v),o=g(v,"P",{});var i=x(o);s=M(i,"connected: "),u=M(i,a),i.forEach(h),v.forEach(h),_=T(n),C=g(n,"DIV",{});var S=x(C);c=g(S,"TEXTAREA",{id:!0,class:!0}),x(c).forEach(h),I=T(S),b=g(S,"BUTTON",{"data-svelte-h":!0}),w(b)!=="svelte-jr3xf5"&&(b.textContent=N),S.forEach(h),L=T(n),k=g(n,"DIV",{});var V=x(k);D=g(V,"H3",{"data-svelte-h":!0}),w(D)!=="svelte-1fkupqc"&&(D.textContent=q),j=T(V),O=g(V,"UL",{});var B=x(O);for(let z=0;z<d.length;z+=1)d[z].l(B);B.forEach(h),V.forEach(h),this.h()},h(){R(c,"id","send"),R(c,"class","svelte-17de7ug")},m(n,v){E(n,e,v),p(e,l),p(e,r),p(e,o),p(o,s),p(o,u),E(n,_,v),E(n,C,v),p(C,c),X(c,f[2]),p(C,I),p(C,b),E(n,L,v),E(n,k,v),p(k,D),p(k,j),p(k,O);for(let i=0;i<d.length;i+=1)d[i]&&d[i].m(O,null);H||(U=[F(c,"input",f[4]),F(b,"click",f[5])],H=!0)},p(n,v){if(v&2&&a!==(a=n[1]?"true":"false")&&Z(u,a),v&4&&X(c,n[2]),v&8){P=J(n[3]);let i;for(i=0;i<P.length;i+=1){const S=K(n,P,i);d[i]?d[i].p(S,v):(d[i]=Y(S),d[i].c(),d[i].m(O,null))}for(;i<d.length;i+=1)d[i].d(1);d.length=P.length}},d(n){n&&(h(e),h(_),h(C),h(L),h(k)),ne(d,n),H=!1,ee(U)}}}function Y(f){let e,l=f[7]+"",t;return{c(){e=m("li"),t=A(l)},l(r){e=g(r,"LI",{});var o=x(e);t=M(o,l),o.forEach(h)},m(r,o){E(r,e,o),p(e,t)},p(r,o){o&8&&l!==(l=r[7]+"")&&Z(t,l)},d(r){r&&h(e)}}}function ce(f){let e,l,t="Caller (initiator)",r,o,s=!f[1]&&Q(),a=f[1]&&W(f);return{c(){e=m("div"),l=m("p"),l.textContent=t,r=y(),s&&s.c(),o=y(),a&&a.c()},l(u){e=g(u,"DIV",{});var _=x(e);l=g(_,"P",{"data-svelte-h":!0}),w(l)!=="svelte-1id8pt1"&&(l.textContent=t),r=T(_),s&&s.l(_),o=T(_),a&&a.l(_),_.forEach(h)},m(u,_){E(u,e,_),p(e,l),p(e,r),s&&s.m(e,null),p(e,o),a&&a.m(e,null)},p(u,[_]){u[1]?s&&(s.d(1),s=null):s||(s=Q(),s.c(),s.m(e,o)),u[1]?a?a.p(u,_):(a=W(u),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},i:G,o:G,d(u){u&&h(e),s&&s.d(),a&&a.d()}}}let fe=!0;function ue(f,e,l){let t=null,r=!1,o="",s=[];(async()=>{console.log("onload...");const C=await se();l(0,t=new oe({initiator:fe,trickle:!1,config:{iceServers:C}})),t.on("error",c=>console.log("error",c)),t.on("signal",async c=>{const I=await ae(c);t==null||t.signal(I)}),t.on("connect",()=>{console.log("CONNECT"),l(1,r=!0),t==null||t.send("whatever"+new Date().toISOString())}),t.on("close",()=>{console.log("CLOSE"),l(1,r=!1)}),t.on("error",c=>{console.error("error",c),l(1,r=!1)}),t.on("data",c=>{console.log("GOT data:",c);try{s.push(c.toString()),l(3,s)}catch{console.error("could not parse data to string :/",c)}})})();function u(){o=this.value,l(2,o)}return[t,r,o,s,u,()=>{t==null||t.send(o),l(2,o="")}]}class me extends te{constructor(e){super(),le(this,e,ue,ce,$,{})}}export{me as component,pe as universal};
