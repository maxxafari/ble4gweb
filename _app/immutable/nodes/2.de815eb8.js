import{s as Z,n as z,r as $}from"../chunks/scheduler.52935eb4.js";import{S as tt,i as et,g as f,s as N,m as P,B as nt,h as d,f as _,c as O,j as S,z as I,n as j,k as R,A as r,a as q,C as D,o as W}from"../chunks/index.573d0439.js";import{c as at}from"../chunks/BLEServiceBuilder.6eed7d52.js";const ot=!1,rt=!0,pt=Object.freeze(Object.defineProperty({__proto__:null,prerender:rt,ssr:ot},Symbol.toStringTag,{value:"Module"}));function lt(a){let t,o="Disconnect",e,s;return{c(){t=f("button"),t.textContent=o},l(n){t=d(n,"BUTTON",{"data-svelte-h":!0}),I(t)!=="svelte-fs9pv2"&&(t.textContent=o)},m(n,i){q(n,t,i),e||(s=D(t,"click",a[9]),e=!0)},p:z,d(n){n&&_(t),e=!1,s()}}}function ct(a){let t,o="Connect To Ble",e,s;return{c(){t=f("button"),t.textContent=o},l(n){t=d(n,"BUTTON",{"data-svelte-h":!0}),I(t)!=="svelte-fhymu3"&&(t.textContent=o)},m(n,i){q(n,t,i),e||(s=D(t,"click",a[8]),e=!0)},p:z,d(n){n&&_(t),e=!1,s()}}}function st(a){let t,o,e,s,n,i,l,E="update",k,m,L,v,T,y,x,B,A,b,C="Off",w,h,H="On",G,J;function K(c,p){return c[0]?lt:ct}let V=K(a),u=V(a);return{c(){t=f("meta"),o=N(),e=f("section"),u.c(),s=N(),n=f("ul"),i=f("li"),l=f("button"),l.textContent=E,k=N(),m=f("li"),L=P("Led: "),v=P(a[1]),T=N(),y=f("li"),x=P("Battery: "),B=P(a[2]),A=N(),b=f("button"),b.textContent=C,w=N(),h=f("button"),h.textContent=H,this.h()},l(c){const p=nt("svelte-1n9drxs",document.head);t=d(p,"META",{name:!0,content:!0}),p.forEach(_),o=O(c),e=d(c,"SECTION",{});var g=S(e);u.l(g),s=O(g),n=d(g,"UL",{});var U=S(n);i=d(U,"LI",{});var Q=S(i);l=d(Q,"BUTTON",{"data-svelte-h":!0}),I(l)!=="svelte-1924rdz"&&(l.textContent=E),Q.forEach(_),k=O(U),m=d(U,"LI",{});var M=S(m);L=j(M,"Led: "),v=j(M,a[1]),M.forEach(_),T=O(U),y=d(U,"LI",{});var F=S(y);x=j(F,"Battery: "),B=j(F,a[2]),F.forEach(_),U.forEach(_),A=O(g),b=d(g,"BUTTON",{"data-svelte-h":!0}),I(b)!=="svelte-1t8gbhd"&&(b.textContent=C),w=O(g),h=d(g,"BUTTON",{"data-svelte-h":!0}),I(h)!=="svelte-vndrdl"&&(h.textContent=H),g.forEach(_),this.h()},h(){document.title="Control",R(t,"name","description"),R(t,"content","Control app")},m(c,p){r(document.head,t),q(c,o,p),q(c,e,p),u.m(e,null),r(e,s),r(e,n),r(n,i),r(i,l),r(n,k),r(n,m),r(m,L),r(m,v),r(n,T),r(n,y),r(y,x),r(y,B),r(e,A),r(e,b),r(e,w),r(e,h),G||(J=[D(l,"click",a[10]),D(b,"click",a[11]),D(h,"click",a[12])],G=!0)},p(c,[p]){V===(V=K(c))&&u?u.p(c,p):(u.d(1),u=V(c),u&&(u.c(),u.m(e,s))),p&2&&W(v,c[1]),p&4&&W(B,c[2])},i:z,o:z,d(c){c&&(_(o),_(e)),_(t),u.d(),G=!1,$(J)}}}const X="a3941db0-a97c-4cf1-943f-a25ff9ba40cd",it="5b8c0ab6-a058-4684-b2b6-4a0a692e2d45";async function Y(a){return await ut(await a.readValue())}async function ut(a){const t=new Uint8Array(a.buffer);return console.log("valueArray",t),[t[0],t[1]]}function ft(a,t,o){let e,s=!1,n,i,l,E,k;async function m(){var w;if(o(7,e=await navigator.bluetooth.requestDevice({filters:[{namePrefix:"nrf52"}],optionalServices:[X,"battery_service"]})),!e.gatt)throw new Error("No GATT server");if(n=await((w=e.gatt)==null?void 0:w.connect()),!n)throw new Error("No GATT server");if(i=await(n==null?void 0:n.getPrimaryService(X)),!i)throw new Error("No LED service");if(l=await i.getCharacteristic(it),!l)throw new Error("No LED characteristic");console.log("found ledCharacteristic",l),console.log("add battery value"),(await at(n)).onNotification(h=>{console.log("battery value",h),o(2,k=h)}),o(1,E=await Y(l))}async function L(){var C;await((C=e==null?void 0:e.gatt)==null?void 0:C.disconnect()),o(7,e=void 0)}async function v(){l&&o(1,E=await Y(l))}async function T(C,w){l&&(await l.writeValue(new Uint8Array([C,w])),v())}const y=()=>m(),x=()=>L(),B=()=>v(),A=()=>T(0,0),b=()=>T(1,1);return a.$$.update=()=>{a.$$.dirty&128&&o(0,s=!!e)},[s,E,k,m,L,v,T,e,y,x,B,A,b]}class mt extends tt{constructor(t){super(),et(this,t,ft,st,Z,{})}}export{mt as component,pt as universal};
