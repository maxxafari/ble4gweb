import{s as fe,r as ie,c as ue,n as de,b as pe}from"../chunks/scheduler.aa60952c.js";import{S as me,i as _e,s as y,g as b,r as ve,B as he,f as s,c as S,h as g,j as N,u as be,a as _,A as E,v as ge,C as D,d as we,t as Ce,w as ke,y as I,m as se,n as re,k as U,D as q,E as ye,F as Z,G as Se}from"../chunks/index.bdada946.js";import{G as xe}from"../chunks/Gps.7a594be5.js";import{e as Te,c as Ee,p as Ae}from"../chunks/peers.e0652c7d.js";import{w as ae}from"../chunks/index.9adb9ad6.js";function $(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}const Le=!1,Ne=!0,Xe=Object.freeze(Object.defineProperty({__proto__:null,prerender:Ne,ssr:Le},Symbol.toStringTag,{value:"Module"})),De=async e=>{console.info("Creating new peer2"),await Ee(Ae,e)},ce=ae(Te,()=>(console.info("new subscription for perStore2"),De(ce),()=>{console.info("No subscription  peer2")})),P=ae({gear:"N",speed:0,direction:"C"}),Ie=()=>{P.update(e=>({...e,speed:0,gear:"N"}))},Pe=()=>{P.update(e=>({...e,direction:"L"}))},Oe=()=>{P.update(e=>({...e,direction:"R"}))},Ue=()=>{P.update(e=>({...e,direction:"C"}))},je=()=>{P.update(e=>({...e,gear:"F"}))},Re=()=>{P.update(e=>({...e,gear:"R"}))},Ve=()=>{P.update(e=>({...e,gear:"N"}))},j={left:Pe,right:Oe,center:Ue,forward:je,reverse:Re,neutral:Ve,stop:Ie};function He(e){if(!e.repeat)switch(e.key){case"ArrowUp":j.forward();break;case"ArrowDown":j.reverse();break;case"ArrowLeft":j.left();break;case"ArrowRight":j.right();break;case" ":j.stop();break}}function Me(e){switch(e.key){case"ArrowUp":case"ArrowDown":j.neutral();break;case"ArrowLeft":case"ArrowRight":j.center();break}}function ee(e,n,o){const l=e.slice();return l[12]=n[o],l}function te(e){let n,o="Waiting for call (NOT initiator)",l,i,r="<h4>Waiting for call from peer1</h4>";return{c(){n=b("p"),n.textContent=o,l=y(),i=b("div"),i.innerHTML=r},l(c){n=g(c,"P",{"data-svelte-h":!0}),I(n)!=="svelte-y1cfax"&&(n.textContent=o),l=S(c),i=g(c,"DIV",{"data-svelte-h":!0}),I(i)!=="svelte-pb42gt"&&(i.innerHTML=r)},m(c,u){_(c,n,u),_(c,l,u),_(c,i,u)},d(c){c&&(s(n),s(l),s(i))}}}function ne(e){let n,o="<h4>Connected to peer1</h4>",l,i,r,c,u,x="Send",d,a,m="0",k,v,F="1",w,T,G,A,R,J="data",K,V,W,H,O,L,z,Q,M=$(e[5]),h=[];for(let t=0;t<M.length;t+=1)h[t]=le(ee(e,M,t));let C=!e[3].mediaStream&&oe();return{c(){n=b("div"),n.innerHTML=o,l=y(),i=b("div"),r=b("textarea"),c=y(),u=b("button"),u.textContent=x,d=y(),a=b("button"),a.textContent=m,k=y(),v=b("button"),v.textContent=F,w=y(),T=b("input"),G=y(),A=b("div"),R=b("h3"),R.textContent=J,K=y(),V=b("ul");for(let t=0;t<h.length;t+=1)h[t].c();W=se(`
		w `),C&&C.c(),H=y(),O=b("div"),L=b("video"),this.h()},l(t){n=g(t,"DIV",{"data-svelte-h":!0}),I(n)!=="svelte-195tsj"&&(n.innerHTML=o),l=S(t),i=g(t,"DIV",{});var f=N(i);r=g(f,"TEXTAREA",{id:!0,class:!0}),N(r).forEach(s),c=S(f),u=g(f,"BUTTON",{"data-svelte-h":!0}),I(u)!=="svelte-16kuoif"&&(u.textContent=x),f.forEach(s),d=S(t),a=g(t,"BUTTON",{"data-svelte-h":!0}),I(a)!=="svelte-tsty6j"&&(a.textContent=m),k=S(t),v=g(t,"BUTTON",{"data-svelte-h":!0}),I(v)!=="svelte-ycwsfx"&&(v.textContent=F),w=S(t),T=g(t,"INPUT",{type:!0,min:!0,max:!0}),G=S(t),A=g(t,"DIV",{});var p=N(A);R=g(p,"H3",{"data-svelte-h":!0}),I(R)!=="svelte-1fkupqc"&&(R.textContent=J),K=S(p),V=g(p,"UL",{});var B=N(V);for(let X=0;X<h.length;X+=1)h[X].l(B);B.forEach(s),p.forEach(s),W=re(t,`
		w `),C&&C.l(t),H=S(t),O=g(t,"DIV",{class:!0});var Y=N(O);L=g(Y,"VIDEO",{class:!0}),N(L).forEach(s),Y.forEach(s),this.h()},h(){U(r,"id","send"),U(r,"class","svelte-12v1rwn"),U(T,"type","range"),U(T,"min","0"),U(T,"max","180"),L.autoplay=!0,L.muted=!0,U(L,"class","svelte-12v1rwn"),U(O,"class","video-container")},m(t,f){_(t,n,f),_(t,l,f),_(t,i,f),E(i,r),q(r,e[4]),E(i,c),E(i,u),_(t,d,f),_(t,a,f),_(t,k,f),_(t,v,f),_(t,w,f),_(t,T,f),q(T,e[2]),_(t,G,f),_(t,A,f),E(A,R),E(A,K),E(A,V);for(let p=0;p<h.length;p+=1)h[p]&&h[p].m(V,null);_(t,W,f),C&&C.m(t,f),_(t,H,f),_(t,O,f),E(O,L),e[11](L),z||(Q=[D(r,"input",e[6]),D(u,"click",e[7]),D(a,"click",e[8]),D(v,"click",e[9]),D(T,"change",e[10]),D(T,"input",e[10])],z=!0)},p(t,f){if(f&16&&q(r,t[4]),f&4&&q(T,t[2]),f&32){M=$(t[5]);let p;for(p=0;p<M.length;p+=1){const B=ee(t,M,p);h[p]?h[p].p(B,f):(h[p]=le(B),h[p].c(),h[p].m(V,null))}for(;p<h.length;p+=1)h[p].d(1);h.length=M.length}t[3].mediaStream?C&&(C.d(1),C=null):C||(C=oe(),C.c(),C.m(H.parentNode,H))},d(t){t&&(s(n),s(l),s(i),s(d),s(a),s(k),s(v),s(w),s(T),s(G),s(A),s(W),s(H),s(O)),ye(h,t),C&&C.d(t),e[11](null),z=!1,ie(Q)}}}function le(e){let n,o=e[12]+"",l;return{c(){n=b("li"),l=se(o)},l(i){n=g(i,"LI",{});var r=N(n);l=re(r,o),r.forEach(s)},m(i,r){_(i,n,r),E(n,l)},p:de,d(i){i&&s(n)}}}function oe(e){let n,o="No video streamed";return{c(){n=b("p"),n.textContent=o},l(l){n=g(l,"P",{"data-svelte-h":!0}),I(n)!=="svelte-1p0v38x"&&(n.textContent=o)},m(l,i){_(l,n,i)},d(l){l&&s(n)}}}function Be(e){let n,o,l,i,r,c,u,x,d=!e[3].connected&&te(),a=e[3].connected&&ne(e);return r=new xe({}),{c(){n=y(),o=b("div"),d&&d.c(),l=y(),a&&a.c(),i=y(),ve(r.$$.fragment),this.h()},l(m){he("svelte-1y0w2j6",document.head).forEach(s),n=S(m),o=g(m,"DIV",{});var v=N(o);d&&d.l(v),l=S(v),a&&a.l(v),i=S(v),be(r.$$.fragment,v),v.forEach(s),this.h()},h(){document.title="Peer2"},m(m,k){_(m,n,k),_(m,o,k),d&&d.m(o,null),E(o,l),a&&a.m(o,null),E(o,i),ge(r,o,null),c=!0,u||(x=[D(window,"keydown",Z(He)),D(window,"keyup",Z(Me))],u=!0)},p(m,[k]){m[3].connected?d&&(d.d(1),d=null):d||(d=te(),d.c(),d.m(o,l)),m[3].connected?a?a.p(m,k):(a=ne(m),a.c(),a.m(o,i)):a&&(a.d(1),a=null)},i(m){c||(we(r.$$.fragment,m),c=!0)},o(m){Ce(r.$$.fragment,m),c=!1},d(m){m&&(s(n),s(o)),d&&d.d(),a&&a.d(),ke(r),u=!1,ie(x)}}}function Fe(e,n,o){let l;ue(e,ce,w=>o(3,l=w));let i="",r=[],c,u=l.command,x=0;P.subscribe(w=>{u.setStearing(w)});function d(){i=this.value,o(4,i)}const a=()=>{var w;(w=l.dataConn)==null||w.send(i),o(4,i="")},m=()=>u.setLed(1,!1),k=()=>u.setLed(1,!0);function v(){x=Se(this.value),o(2,x)}function F(w){pe[w?"unshift":"push"](()=>{c=w,o(0,c),o(3,l)})}return e.$$.update=()=>{e.$$.dirty&9&&(l.mediaStream&&c&&o(0,c.srcObject=l.mediaStream,c),l.dataConn&&(l.dataConn.on("data",w=>{console.log("got data: ",w)}),o(1,u=l.command))),e.$$.dirty&6&&x&&u.setServo(1,x)},[c,u,x,l,i,r,d,a,m,k,v,F]}class Je extends me{constructor(n){super(),_e(this,n,Fe,Be,fe,{})}}export{Je as component,Xe as universal};
