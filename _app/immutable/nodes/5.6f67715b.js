import{s as fe,n as J,r as oe,c as de,b as pe}from"../chunks/scheduler.aa60952c.js";import{S as me,i as _e,s as w,g as _,B as ve,f as r,c as y,h as v,j as I,a as p,A as x,C as L,y as D,m as ae,n as re,k as j,D as K,F as he,G as $,E as be}from"../chunks/index.1eddc4da.js";import{e as Ce,c as ge,p as ke}from"../chunks/peers.d8a03dfc.js";import{w as ce}from"../chunks/index.9adb9ad6.js";function ee(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}const we=!1,ye=!0,Ae=Object.freeze(Object.defineProperty({__proto__:null,prerender:ye,ssr:we},Symbol.toStringTag,{value:"Module"})),Se=async e=>{console.info("Creating new peer2"),await ge(ke,e)},ue=ce(Ce,()=>(console.info("new subscription for perStore2"),Se(ue),()=>{console.info("No subscription  peer2")})),P=ce({gear:"N",speed:0,direction:"C"}),xe=()=>{P.update(e=>({...e,speed:0,gear:"N"}))},Te=()=>{P.update(e=>({...e,direction:"L"}))},Ee=()=>{P.update(e=>({...e,direction:"R"}))},Ne=()=>{P.update(e=>({...e,direction:"C"}))},Ie=()=>{P.update(e=>({...e,gear:"F"}))},Le=()=>{P.update(e=>({...e,gear:"R"}))},De=()=>{P.update(e=>({...e,gear:"N"}))},T={left:Te,right:Ee,center:Ne,forward:Ie,reverse:Le,neutral:De,stop:xe};function Pe(e){switch(e.keyCode){case 38:T.forward();break;case 40:T.reverse();break;case 37:T.left();break;case 39:T.right();break;case 32:T.stop();break}}function Oe(e){switch(e.keyCode){case 38:T.neutral();break;case 40:T.neutral();break;case 37:T.center();break;case 39:T.center();break}}function te(e,n,a){const l=e.slice();return l[12]=n[a],l}function ne(e){let n,a="Waiting for call (NOT initiator)",l,o,u="<h4>Waiting for call from peer1</h4>";return{c(){n=_("p"),n.textContent=a,l=w(),o=_("div"),o.innerHTML=u},l(i){n=v(i,"P",{"data-svelte-h":!0}),D(n)!=="svelte-y1cfax"&&(n.textContent=a),l=y(i),o=v(i,"DIV",{"data-svelte-h":!0}),D(o)!=="svelte-pb42gt"&&(o.innerHTML=u)},m(i,s){p(i,n,s),p(i,l,s),p(i,o,s)},d(i){i&&(r(n),r(l),r(o))}}}function le(e){let n,a="<h4>Connected to peer1</h4>",l,o,u,i,s,d="Send",g,b,B="0",V,S,F="1",h,k,W,E,U,Q="data",z,H,q,M,O,N,G,Y,R=ee(e[5]),m=[];for(let t=0;t<R.length;t+=1)m[t]=ie(te(e,R,t));let C=!e[3].mediaStream&&se();return{c(){n=_("div"),n.innerHTML=a,l=w(),o=_("div"),u=_("textarea"),i=w(),s=_("button"),s.textContent=d,g=w(),b=_("button"),b.textContent=B,V=w(),S=_("button"),S.textContent=F,h=w(),k=_("input"),W=w(),E=_("div"),U=_("h3"),U.textContent=Q,z=w(),H=_("ul");for(let t=0;t<m.length;t+=1)m[t].c();q=ae(`
		w `),C&&C.c(),M=w(),O=_("div"),N=_("video"),this.h()},l(t){n=v(t,"DIV",{"data-svelte-h":!0}),D(n)!=="svelte-195tsj"&&(n.innerHTML=a),l=y(t),o=v(t,"DIV",{});var c=I(o);u=v(c,"TEXTAREA",{id:!0,class:!0}),I(u).forEach(r),i=y(c),s=v(c,"BUTTON",{"data-svelte-h":!0}),D(s)!=="svelte-16kuoif"&&(s.textContent=d),c.forEach(r),g=y(t),b=v(t,"BUTTON",{"data-svelte-h":!0}),D(b)!=="svelte-tsty6j"&&(b.textContent=B),V=y(t),S=v(t,"BUTTON",{"data-svelte-h":!0}),D(S)!=="svelte-ycwsfx"&&(S.textContent=F),h=y(t),k=v(t,"INPUT",{type:!0,min:!0,max:!0}),W=y(t),E=v(t,"DIV",{});var f=I(E);U=v(f,"H3",{"data-svelte-h":!0}),D(U)!=="svelte-1fkupqc"&&(U.textContent=Q),z=y(f),H=v(f,"UL",{});var A=I(H);for(let X=0;X<m.length;X+=1)m[X].l(A);A.forEach(r),f.forEach(r),q=re(t,`
		w `),C&&C.l(t),M=y(t),O=v(t,"DIV",{class:!0});var Z=I(O);N=v(Z,"VIDEO",{class:!0}),I(N).forEach(r),Z.forEach(r),this.h()},h(){j(u,"id","send"),j(u,"class","svelte-12v1rwn"),j(k,"type","range"),j(k,"min","0"),j(k,"max","180"),N.autoplay=!0,N.muted=!0,j(N,"class","svelte-12v1rwn"),j(O,"class","video-container")},m(t,c){p(t,n,c),p(t,l,c),p(t,o,c),x(o,u),K(u,e[4]),x(o,i),x(o,s),p(t,g,c),p(t,b,c),p(t,V,c),p(t,S,c),p(t,h,c),p(t,k,c),K(k,e[2]),p(t,W,c),p(t,E,c),x(E,U),x(E,z),x(E,H);for(let f=0;f<m.length;f+=1)m[f]&&m[f].m(H,null);p(t,q,c),C&&C.m(t,c),p(t,M,c),p(t,O,c),x(O,N),e[11](N),G||(Y=[L(u,"input",e[6]),L(s,"click",e[7]),L(b,"click",e[8]),L(S,"click",e[9]),L(k,"change",e[10]),L(k,"input",e[10])],G=!0)},p(t,c){if(c&16&&K(u,t[4]),c&4&&K(k,t[2]),c&32){R=ee(t[5]);let f;for(f=0;f<R.length;f+=1){const A=te(t,R,f);m[f]?m[f].p(A,c):(m[f]=ie(A),m[f].c(),m[f].m(H,null))}for(;f<m.length;f+=1)m[f].d(1);m.length=R.length}t[3].mediaStream?C&&(C.d(1),C=null):C||(C=se(),C.c(),C.m(M.parentNode,M))},d(t){t&&(r(n),r(l),r(o),r(g),r(b),r(V),r(S),r(h),r(k),r(W),r(E),r(q),r(M),r(O)),he(m,t),C&&C.d(t),e[11](null),G=!1,oe(Y)}}}function ie(e){let n,a=e[12]+"",l;return{c(){n=_("li"),l=ae(a)},l(o){n=v(o,"LI",{});var u=I(n);l=re(u,a),u.forEach(r)},m(o,u){p(o,n,u),x(n,l)},p:J,d(o){o&&r(n)}}}function se(e){let n,a="No video streamed";return{c(){n=_("p"),n.textContent=a},l(l){n=v(l,"P",{"data-svelte-h":!0}),D(n)!=="svelte-1p0v38x"&&(n.textContent=a)},m(l,o){p(l,n,o)},d(l){l&&r(n)}}}function je(e){let n,a,l,o,u,i=!e[3].connected&&ne(),s=e[3].connected&&le(e);return{c(){n=w(),a=_("div"),i&&i.c(),l=w(),s&&s.c(),this.h()},l(d){ve("svelte-1y0w2j6",document.head).forEach(r),n=y(d),a=v(d,"DIV",{});var b=I(a);i&&i.l(b),l=y(b),s&&s.l(b),b.forEach(r),this.h()},h(){document.title="Peer2"},m(d,g){p(d,n,g),p(d,a,g),i&&i.m(a,null),x(a,l),s&&s.m(a,null),o||(u=[L(window,"keydown",$(Pe)),L(window,"keyup",$(Oe))],o=!0)},p(d,[g]){d[3].connected?i&&(i.d(1),i=null):i||(i=ne(),i.c(),i.m(a,l)),d[3].connected?s?s.p(d,g):(s=le(d),s.c(),s.m(a,null)):s&&(s.d(1),s=null)},i:J,o:J,d(d){d&&(r(n),r(a)),i&&i.d(),s&&s.d(),o=!1,oe(u)}}}function Ve(e,n,a){let l;de(e,ue,h=>a(3,l=h));let o="",u=[],i,s=l.command,d=0;P.subscribe(h=>{s.setStearing(h)});function g(){o=this.value,a(4,o)}const b=()=>{var h;(h=l.dataConn)==null||h.send(o),a(4,o="")},B=()=>s.setLed(1,!1),V=()=>s.setLed(1,!0);function S(){d=be(this.value),a(2,d)}function F(h){pe[h?"unshift":"push"](()=>{i=h,a(0,i),a(3,l)})}return e.$$.update=()=>{e.$$.dirty&9&&(l.mediaStream&&i&&a(0,i.srcObject=l.mediaStream,i),l.dataConn&&(l.dataConn.on("data",h=>{console.log("got data: ",h)}),a(1,s=l.command))),e.$$.dirty&6&&d&&s.setServo(1,d)},[i,s,d,l,o,u,g,b,B,V,S,F]}class Be extends me{constructor(n){super(),_e(this,n,Ve,je,fe,{})}}export{Be as component,Ae as universal};
